# Ãœbungen: Benutzer anlegen unter Linux mit `useradd`

>[!NOTE]
> Nutzt fÃ¼r die Ãœbungen das Kommando `useradd` und **nicht** `adduser`, sofern nicht explizit angegeben. SÃ¤mtliche fÃ¼r die Ãœbungen nÃ¶tigen Informationen sollten in der Manpage von `useradd` zu finden sein. Falls nicht direkt, schaut doch mal ganz unten in die `SEE ALSO` Sektion...
> Falls ihr eine Meldung bekommt, dass `useradd` nicht gefunden wird, Ã¼berprÃ¼ft mal, wie ihr `root` geworden seid: mit `su` oder `su -` bzw. `su -l root`?


## Ãœbung 1: Einfachen Benutzer anlegen
Legt einen neuen Benutzer `someuser` mit dem Kommando `useradd someuser` ohne weitere Optionen an und prÃ¼ft, was passiert.

ğŸ”¹ **Fragen:**
- Wurde das Home-Verzeichnis erstellt? PrÃ¼ft das doch mal mit dem Kommando `ls /home`.
- Wurde der Benutzer etwas gar nicht erstellt? Wie kÃ¶nnt ihr das Ã¼berprÃ¼fen? In welcher Datei stehen denn die Informationen Ã¼ber Benutzer?
- KÃ¶nnt ihr euch als `someuser` anmelden? Probiert das einmal mit dem Kommando `su someuser` als `root` und dann als euer regulÃ¤rer Benutzer.
- Was steht in `/etc/passwd` und `/etc/shadow` fÃ¼r diesen Benutzer?
- Informiert euch Ã¼ber den Sinn und Aufbau der Datei `/etc/shadow`.
- Warum stehen die PasswÃ¶rter nicht mehr in der `/etc/passwd` wie urprÃ¼nglich mal?

## Ãœbung 2: Benutzer mit Home-Verzeichnis anlegen
Legt einen Benutzer `karlos` so an, dass automatisch ein Heimatverzeichnis mit gleichem Namen wie der User angelegt wird, welches zusÃ¤tzlich die "Standarddateien" aus dem *Skeletonverzeichnis* enthÃ¤lt.

ğŸ”¹ **Fragen:**
- Wo befindet sich das neu angelegte Home-Verzeichnis von `karlos`?
- Welche Dateien sind darin enthalten?
- Wo kommen diese Dateien her? Aus welchem Verzeichnis?
- Wie kÃ¶nnte man dafÃ¼r sorgen, dass alle auf diese Weise neu angelegten User zusÃ¤tzlich die Datei `WELCOME.md` in ihrem Heimatverzeichnis haben?

## Ãœbung 3: Benutzer mit individuellem Home-Verzeichnis
Legt einen Benutzer `indie` mit einem Home-Verzeichnis mit Standarddateien an, das aber unter `/srv` und nicht unter `/home` liegt.

ğŸ”¹ **Fragen:**
- Was passiert, wenn man sich (als `root`) mit `su - indie` anmeldet?

## Ãœbung 4: Benutzer mit KSH als Login-Shell anlegen
Legt einen Benutzer `korni` mit der KSH als Login-Shell an. DafÃ¼r mÃ¼sst ihr zuerst die KSH installieren (`apt install ksh`).

ğŸ”¹ **Fragen:**
- Welche Shell wird standardmÃ¤ÃŸig verwendet, wenn keine Shell angegeben wird?
- Wie kann `korni` die Shell nachtrÃ¤glich auf `bash` Ã¤ndern? Gibt es dafÃ¼r ein Kommando? Oder muss das zwingend `root` Ã¼bernehmen?

## Ãœbung 5: Benutzer mit zusÃ¤tzlichen Informationen im  Kommentar / GECOS-Feld anlegen
Speichert beim Anlegen eines neuen Benutzers `karla` zusÃ¤tzlich die Informationen `Karla Testara, Abteilung Testing` im GECOS bzw. Kommentar-Feld.

ğŸ”¹ **Fragen:**
- Wo wird diese Information gespeichert?
- Wie kÃ¶nnte man sie spÃ¤ter Ã¤ndern? Geht das auch mit `useradd` oder braucht man dazu ein anderes Kommando? Versucht doch einmal, den Eintrag nachtrÃ¤glich auf `Karla Testara, Chefin Abteilung Testing` zu Ã¤ndern.

## Ãœbung 6: Ein Passwort fÃ¼r den Benutzer setzen
Sorgt nachtrÃ¤glich dafÃ¼r, dass ihr ein Passwort fÃ¼r einen der neu angelegten Benutzer setzt, so dass sich diese auch am System anmelden kÃ¶nnen, entweder direkt per SSH oder mit dem Kommando `su` ausgefÃ¼hrt als regulÃ¤rer Benutzer.

ğŸ”¹ **Fragen:**
- Geht das auch direkt mit dem Kommando `useradd`? Oder brauchen wir dazu ein anderes Kommando?

## Ãœbung 7: "Vollwertigen" Benutzer anlegen
Legt einen neuen Benutzer so an, dass dieser 

- ein Heimatverzeichnis mit Standarddateien erhÃ¤lt
- im Kommentarfeld sein Vor- und Nachname eingetragen ist
- er die `bash` als Login Shell nutzt
- ein Passwort erhÃ¤lt

ğŸ”¹ **Zusatzfrage:**
* Als Administrator:innen wollen wir keine Kenntnis Ã¼ber die PasswÃ¶rter unserer User haben. Wie kÃ¶nnte man also einen neuen User mit Passwort anlegen, aber dafÃ¼r sorgen, dass wir nachtrÃ¤glich keine Kenntnis Ã¼ber das Passwort haben, bzw. nur bis der Account wirklich genutzt wird?

## Ãœbung 8: Benutzer einer bestimmten Gruppe zuweisen
Legt einen Benutzer `gamie` an und weist ihn direkt der Gruppe `games` zu.

ğŸ”¹ **Fragen:**
- Wie kann Ã¼berprÃ¼ft werden, ob der Benutzer in der Gruppe ist? Vielleicht helfen ja Kommandos wie `group` oder `id` weiter.
- Was ist der Unterschied zwischen `-G` und `-g` von `useradd`, bzw. *primÃ¤re* (`primary`) und *erweiterten* (`supplementary`) Gruppen?

## Ãœbung 9: Benutzer sicher entfernen
Erstellt eine Datei mit Namen `karlos-file` im Verzeichnis `/opt` als `root`. Sorgt nun mit dem Kommando `chown karlos /opt/karlos-file` dafÃ¼r, dass diese Datei `karlos` gehÃ¶rt bzw. zugewiesen wird (`chown` besprechen wir noch).

LÃ¶scht nun den User `karlos` inklusive seines Heimatverzeichnisses mit dem Kommando `userdel` und der entsprechenden Option (-> Manpage). Sind anschlieÃŸend in jedem Fall alle Dateien, die `karlos` "gehÃ¶ren" entfernt? Schaut einmal mit `ls -l` in das Verzeichnis `/opt`. 

## Ãœbung 10: Benutzer mit Ablaufdatum erstellen
Legt einen Benutzer `iamleaving` an, dessen Konto am 31.12.2025 ablÃ¤uft.

ğŸ”¹ **Fragen:**
- Wie kann das Ablaufdatum Ã¼berprÃ¼ft werden? Mit welchem Kommando? Bzw. wo in welcher Datei steht die Information?
- Was passiert nach dem Ablaufdatum? Kann sich der User noch anmelden?

## Ãœbung 11: Benutzer mit bestimmter Benutzer-ID (UID) anlegen
Legt einen neuen Benutzer `fifteenhundred` mit der UID `1500` und an. 

ğŸ”¹ **Fragen:**
- Welche UID hat ein neuer Benutzer ohne diese Option?
- Welche GID hat `fifteenhundred`?
- In welcher Datei werden diese Bereiche festgelegt?

## Ãœbung 12: Passwort-Aging und Account-Sicherheit
Legt einen Benutzer `secured` an und konfiguriert folgende Sicherheitsrichtlinien:

- Passwort muss alle 90 Tage geÃ¤ndert werden
- Warnung 14 Tage vor Ablauf
- Minimale Zeit zwischen PasswortÃ¤nderungen: 7 Tage
- Account wird 30 Tage nach Passwort-Ablauf deaktiviert

ğŸ”¹ **Fragen:**
- Wie kann man sich alle Aging-Informationen eines Users anzeigen lassen?
- Was bedeutet "inactive days" genau?
- In welcher Datei stehen all diese Angaben?
- Gibt es auch hier eine Datei, in der diesbezÃ¼glich Voreinstellungen getroffen werden?

## Ãœbung 13: System-User vs. normale User
Legt einen System-User `sysuser` an, der typische Eigenschaften eines System-Users hat.

ğŸ”¹ **Fragen:**
- Was unterscheidet System-User von normalen Usern?
- Welche Option von `useradd` erstellt System-User?
- Warum sollten System-User keine Login-Shell haben?
- Was ist der Unterschied zwischen `/sbin/nologin` und `/bin/false`?

## Ãœbung 14: User-Modifikation mit usermod
Nehmt den User `indie` aus Ãœbung 3 und:

- Ã„ndert sein Home-Verzeichnis zurÃ¼ck nach `/home/indie`
- Verschiebt dabei den Inhalt mit
- Ã„ndert die Shell auf `ksh`
- Sperrt den Account temporÃ¤r
- Entsperrt ihn anschliessend wieder

ğŸ”¹ **Fragen:**
- Was ist der Unterschied zwischen "Account sperren" und "Passwort sperren"?
- Was passiert in `/etc/shadow` beim Sperren?
- Kann sich `root` als gesperrter User einloggen?

## Ãœbung 15: Benutzer mit `adduser` anlegen
Legt einen neuen Benutzer `newbi` mit dem Kommando `adduser` an.

ğŸ”¹ **Fragen:**
- Was ist der Unterschied zur Verwendung des Kommandos `useradd`?
- Welche einzelnen Schritte fÃ¼hrt `adduser` aus?
- Ist es wirklich ein eigenes von `useradd` unabhÃ¤ngiges Kommando?
- Warum lernen wir nicht einfach nur die Verwendung von `adduser`?
- Schaut doch einmal nach, was `adduser` eigentlich ist, z.B. mit dem Kommando `file /usr/sbin/adduser`. KÃ¶nnt ihr vielleicht sogar genau herausfinden, was `adduser` macht?

## Ãœbung 16: User manuelle ohne `useradd` oder `adduser` erstellen
Mal angenommen, ihr hÃ¤ttet weder das Kommando `useradd`, noch `adduser` zur VerfÃ¼gung, jedoch einen Texteditor, zufÃ¤lligerweise einen gesaltenen Passworthash und `root` -Rechte. 

KÃ¶nntet ihr auch so einen vollwertigen Benutzeraccount erstellen?

Macht euch Gedanken, welche Dateien bei der Erstellung eines Benutzers editiert werden und probiert es doch einfach mal aus.

**Tipp 1:** Um an einen Passwort-Hash zu kommen, kÃ¶nntet ihr ja mal versuchen, einen bereits vorhandenen zu kopieren oder so...

**Tipp 2:** Oder ihr erstellt euch einfach einen mit dem Kommando `openssl passwd -6`. ErklÃ¤rung: Die Option `-6` steht fÃ¼r den SHA-512 Hash-Algorithmus, es wird ein zufÃ¤lliger Salt erzeugt und ihr werdet interaktiv nach einem Passwort gefragt.
